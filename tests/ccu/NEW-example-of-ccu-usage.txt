# file ccu.ksd
prefix ccu: <http://www.geisel-software.com/kgm/ClickHouseUtils#>

class ccu:Series
 ccu:tablename xsd:string
end

# --------

# file t.ksd
# prefix : .. this graph uri ..

class :TestData
 :testdata xsd:float
end

class :Test
 :tdata :TestData
 :vs ccu:Series
end

:t1 rdf:type :Test .
:t1 :tdata [ rdf:type TestData; :testdata 1.0 ];
:s1 rdf:type ccu:Series; ccu:tablename "hkjhkj" .
:t1 :vs :s1 .

# -------

kgm graph import /ccu/ccu-series ccu.ksd
kgm graph import /tests/t t.ksd

# -------

db = Database(fuseki_url = ..., clickhouse = ...)
g = db.get_graph("/tests/t", ["/ccu/*"])
g.prefix_remap({"ccu:": "ccu1:"})
g.graph_prefix_remap({"/tests/t": "t:"})

g.select("select * { ?t rdf:type t:Test; t:tdata ?v; t:vs ?vs. ?vs ccu1:tablename ?vs_tn }")

t = g.create_user_object("t:Test")
t.tdata = g.create_user_object("t:TestData")
t.tdata.testdata = 1.0
t.vs = g.create_user_object("ccu1:Series")
t.vs.tablename = "ttt"
